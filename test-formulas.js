const formulas = require('./routes/formulas');

const measures = [{ "id": 1004, "patientId": 12, "date": "30-01-2023", "data": { "newLesions": "NO", "ntl1": "UI", "tl1": "15", "tl2": "10", "tl3": "1", "tl4": "15" }, "calculus": { "data": { "targetLesions": { "sumDiameters": 41, "nadir": 15, "percentageFromBasal": "-44.59", "percentageFromNadir": "173.33", "response": "PD" }, "nonTargetLesions": { "response": "PD" }, "response": "PD" } } }, { "id": 1003, "patientId": 12, "date": "28-01-2023", "data": { "newLesions": "NO", "ntl1": "ABS", "tl1": "34", "tl2": "1", "tl3": "1", "tl4": "9" }, "calculus": { "data": { "targetLesions": { "sumDiameters": 45, "nadir": 15, "percentageFromBasal": "-39.19", "percentageFromNadir": "200.00", "response": "CR" }, "nonTargetLesions": { "response": "CR" }, "response": "CR" } } }, { "id": 1002, "patientId": 12, "date": "26-01-2023", "data": { "newLesions": "NO", "ntl1": "ABS", "tl1": "5", "tl2": "4", "tl3": "3", "tl4": "3" }, "calculus": { "data": { "targetLesions": { "sumDiameters": 15, "nadir": 40, "percentageFromBasal": "-79.73", "percentageFromNadir": "-62.50", "response": "CR" }, "nonTargetLesions": { "response": "CR" }, "response": "CR" } } }, { "id": 1001, "patientId": 12, "date": "16-01-2023", "data": { "newLesions": "NO", "ntl1": "UC", "tl1": "11", "tl2": "12", "tl3": "10", "tl4": "7" }, "calculus": { "data": { "targetLesions": { "sumDiameters": 40, "nadir": 74, "percentageFromBasal": "-45.95", "percentageFromNadir": "-45.95", "response": "CR" }, "nonTargetLesions": { "response": "NoCR/NoPD" }, "response": "PR" } } }];

const lesions = [{"id":"tl1","localization":"BRAIN","verbatim":"Frontal lobe","lymphNode":"NO","basal":"12"},{"id":"tl2","localization":"LIVER","verbatim":"Hepatic lobe","lymphNode":"NO","basal":"23"},{"id":"tl3","localization":"LUNG","verbatim":"Multiples nodes","lymphNode":"NO","basal":"23"},{"id":"tl4","localization":"LYMPH NODES","verbatim":"Paraaortic lymph nod","lymphNode":"YES","basal":"16"}];

console.log(formulas.calculateTargetResponse(measures[1].data, lesions, measures[1].calculus.data.targetLesions.sumDiameters, measures[1].calculus.data.targetLesions.nadir, measures[1].calculus.data.targetLesions.percentageFromBasal, measures[1].calculus.data.targetLesions.percentageFromNADIR))